<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitFreeDocify - Loading...</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
        }
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 4px solid #ffffff;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .error {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
            color: #ffffff;
        }
        .success {
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.3);
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
            color: #ffffff;
        }
    </style>
</head>
<body>
    <div class="min-h-screen flex items-center justify-center p-4">
        <div class="max-w-lg w-full text-center text-white">
            <div class="mb-8">
                <h1 class="text-4xl font-bold mb-4">GitFreeDocify</h1>
                <p class="text-xl opacity-80">AI-Powered Documentation Generator</p>
            </div>

            <div id="loading-state" class="mb-8">
                <div class="spinner mx-auto mb-4"></div>
                <p>Loading application...</p>
            </div>

            <div id="status-container">
                <!-- Status messages will appear here -->
            </div>

            <div class="bg-white/10 backdrop-blur-md rounded-2xl p-6 mb-8">
                <h2 class="text-2xl font-bold mb-4">Quick Start</h2>
                <p class="mb-4 opacity-80">Generate professional documentation for your GitHub repositories using AI.</p>
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <button onclick="trySignIn()" class="bg-white text-purple-600 px-6 py-3 rounded-lg font-bold hover:bg-gray-100 transition-colors">
                        üöÄ Get Started
                    </button>
                    <button onclick="showDebugInfo()" class="border-2 border-white text-white px-6 py-3 rounded-lg font-bold hover:bg-white/10 transition-colors">
                        üîß Debug Info
                    </button>
                </div>
            </div>

            <div id="debug-info" class="hidden bg-black/20 rounded-xl p-4 text-left text-sm">
                <h3 class="font-bold mb-2">Debug Information:</h3>
                <div id="debug-content"></div>
            </div>

            <div class="bg-white/10 backdrop-blur-md rounded-xl p-4 mt-8">
                <p class="text-sm opacity-80">Developed with ‚ù§Ô∏è by <strong>Kushagra Jain</strong></p>
                <a href="https://github.com/devforgekush" target="_blank" class="inline-block mt-2 text-sm underline hover:no-underline">
                    GitHub Profile
                </a>
            </div>
        </div>
    </div>

    <script>
        const statusContainer = document.getElementById('status-container');
        const loadingState = document.getElementById('loading-state');
        const debugInfo = document.getElementById('debug-info');
        const debugContent = document.getElementById('debug-content');

        function addStatus(message, type = 'info') {
            const div = document.createElement('div');
            div.className = type === 'error' ? 'error' : type === 'success' ? 'success' : 'text-white/80 mb-2';
            div.innerHTML = `<p>${message}</p>`;
            statusContainer.appendChild(div);
        }

        function showDebugInfo() {
            debugInfo.classList.toggle('hidden');
            const info = {
                'User Agent': navigator.userAgent,
                'Current URL': window.location.href,
                'Viewport': `${window.innerWidth}x${window.innerHeight}`,
                'Screen': `${screen.width}x${screen.height}`,
                'Connection': navigator.connection ? navigator.connection.effectiveType : 'Unknown',
                'Timestamp': new Date().toISOString()
            };
            
            debugContent.innerHTML = Object.entries(info)
                .map(([key, value]) => `<div><strong>${key}:</strong> ${value}</div>`)
                .join('');
        }

        function trySignIn() {
            addStatus('üîÑ Attempting to access authentication...', 'info');
            window.location.href = '/auth/signin';
        }

        // Test API connectivity
        async function testAPI() {
            try {
                addStatus('üîç Testing API connectivity...', 'info');
                const response = await fetch('/api/debug');
                if (response.ok) {
                    const data = await response.json();
                    addStatus('‚úÖ API is working! Environment loaded successfully.', 'success');
                    // If API works, try to redirect to main app
                    setTimeout(() => {
                        addStatus('üîÑ Redirecting to main application...', 'info');
                        window.location.href = '/';
                    }, 2000);
                } else {
                    addStatus(`‚ö†Ô∏è API responded with status: ${response.status}`, 'error');
                }
            } catch (error) {
                addStatus(`‚ùå API connection failed: ${error.message}`, 'error');
                addStatus('üí° The application may still work. Try the Get Started button above.', 'info');
            }
        }

        // Test Next.js pages
        async function testPages() {
            const pages = ['/auth/signin', '/dashboard', '/generate'];
            for (const page of pages) {
                try {
                    const response = await fetch(page, { method: 'HEAD' });
                    if (response.ok) {
                        addStatus(`‚úÖ Page ${page} is accessible`, 'success');
                    } else {
                        addStatus(`‚ö†Ô∏è Page ${page} returned status: ${response.status}`, 'error');
                    }
                } catch (error) {
                    addStatus(`‚ùå Page ${page} failed: ${error.message}`, 'error');
                }
            }
        }

        // Initialize diagnostics
        setTimeout(() => {
            loadingState.style.display = 'none';
            addStatus('üåê Static page loaded successfully', 'success');
            testAPI();
            setTimeout(testPages, 1000);
        }, 1000);

        // Add console logging
        console.log('GitFreeDocify Diagnostic Page Loaded');
        console.log('Current URL:', window.location.href);
        console.log('User Agent:', navigator.userAgent);
    </script>
</body>
</html>
